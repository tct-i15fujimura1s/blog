---
layout: post
title:  "TechFULプラクティス問題「Xor Rush」"
date:   2021-10-18 13:12:00 +0900
categories: jekyll update
tags:
- TechFUL
- TechFUL難易度5
- プラクティス問題
- 整数論
---

## 問題

[https://techful-programming.com/user/practice/problem/coding/1998](https://techful-programming.com/user/practice/problem/coding/1998)

```math
\sum_{(a, b) \in A \otimes B} a \oplus b
```

を求める問題です。

## 考えたこと

$NM$ が大きいので、愚直に計算すると、間に合いません。

ビット演算が関連するときは桁ごとに考えるのがセオリーなので、桁ごとに考えます。
ある桁のビットのみ考えるとしたとき、和を復元することが可能なので、以下では $A, B$ を $0, 1$ からなる数列として考えます。

ここまでくればもう簡単でしょう。
- $A_i = 0$ のとき、 $1$ であるような $B_j$ のみを考えるとよいです。
- $A_i = 1$ のとき、 $0$ であるような $B_j$ のみを考えるとよいです。
このようにすると、 $B_j$ のうちの $0, 1$ の個数を数えれば良いことがわかります。

## コード

```python
N, M = map(int, input().split())
A = list(map(int, input().split()))
B = list(map(int, input().split()))

xorsum = 0

# 入力は2↑20未満
for bit in range(20):
  # count[i] = B のうちの、 `bit` 桁目が `i` である値の個数
  count = [0, 0]
  for b in B:
    count[(b >> bit) & 1] += 1
  
  # ビットが逆の値の個数を足す
  xorsum += sum(count[1 ^ ((a >> bit) & 1)] for a in A) << bit

print(xorsum)
```